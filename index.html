<!DOCTYPE html>
  <html lang="en" dir="ltr">
    <head>
      <meta charset="utf-8">
      <title>Duncan's Language Translator</title>
      <link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
    </head>
    <body>
      <style>
        img {
          max-height: 50px;
          width: auto;
        }
        th {
          text-align: center;
          width: 100px;
        }
        .centercol {
          width: 5px;
        }
        td {
          text-align: center;
        }
        .typeheader {
          background-color: #ffcf4f;
          font-weight: bold;
        }
      </style>

      <p>Intermediate Language key:</p>
      <table>
        <tr>
          <th>English Sound</th>
          <th>English Example</th>
          <th>International Phonetic Alphabet</th>
          <th>Intermediate Language</th>
          <th class="centercol"></th>
          <th>English Sound</th>
          <th>English Example</th>
          <th>International Phonetic Alphabet</th>
          <th>Intermediate Language</th>
        </tr>
        <tr>
          <td colspan="4" class="typeheader">Short Vowels</td>
          <td></td>
          <td colspan="4" class="typeheader">Fricatives</td>
        </tr>
        <tr>
          <td>i</td>
          <td>bit</td>
          <td>ɪ</td>
          <td>i</td>
          <td></td>
          <td>v</td>
          <td>view</td>
          <td>v</td>
          <td>v</td>
        </tr>
        <tr>
          <td>e</td>
          <td>bet</td>
          <td>ɛ</td>
          <td>e</td>
          <td></td>
          <td>f</td>
          <td>few</td>
          <td>f</td>
          <td>f</td>
        </tr>
        <tr>
          <td>u</td>
          <td>butt</td>
          <td>ʌ</td>
          <td>u</td>
          <td></td>
          <td>th</td>
          <td>thine</td>
          <td>ð</td>
          <td>T</td>
        </tr>
        <tr>
          <td>a</td>
          <td>bat</td>
          <td>a</td>
          <td>a</td>
          <td></td>
          <td>th</td>
          <td>thin</td>
          <td>θ</td>
          <td>H</td>
        </tr>
        <tr>
          <td>o</td>
          <td>bot</td>
          <td>ɒ</td>
          <td>o</td>
          <td></td>
          <td>si</td>
          <td>vision</td>
          <td>ʒ</td>
          <td>J</td>
        </tr>
        <tr>
          <td>i</td>
          <td>bite</td>
          <td>ʌɪ</td>
          <td>I</td>
          <td></td>
          <td>sh</td>
          <td>fish</td>
          <td>ʃ</td>
          <td>S</td>
        </tr>
        <tr>
          <td colspan="4" class="typeheader">Long Vowels</td>
          <td></td>
          <td>s</td>
          <td>sue</td>
          <td>s</td>
          <td>s</td>
        </tr>
        <tr>
          <td>oo</td>
          <td>boot</td>
          <td>uː</td>
          <td>U</td>
          <td></td>
          <td>z</td>
          <td>zoo</td>
          <td>z</td>
          <td>z</td>
        </tr>
        <tr>
          <td>ai</td>
          <td>bait</td>
          <td>eɪ</td>
          <td>A</td>
          <td></td>
          <td>h</td>
          <td>hello</td>
          <td>h</td>
          <td>h</td>
        </tr>
        <tr>
          <td>ough</td>
          <td>bought</td>
          <td>ɔː</td>
          <td>Q</td>
          <td></td>
          <td colspan="4" class="typeheader">Approximants</td>
        </tr>
        <tr>
          <td>ee</td>
          <td>beet</td>
          <td>iː</td>
          <td>E</td>
          <td></td>
          <td>r</td>
          <td>right</td>
          <td>ɹ</td>
          <td>r</td>
        </tr>
        <tr>
          <td>oa</td>
          <td>boat</td>
          <td>o:</td>
          <td>O</td>
          <td></td>
          <td>l</td>
          <td>light</td>
          <td>l</td>
          <td>l</td>
        </tr>
        <tr>
          <td colspan="4" class="typeheader">Nasals</td>
          <td></td>
          <td colspan="4" class="typeheader">Combos</td>
        </tr>
        <tr>
          <td>n</td>
          <td>night</td>
          <td>n</td>
          <td>n</td>
          <td></td>
          <td>ch</td>
          <td>chin</td>
          <td>tʃ</td>
          <td>c</td>
        </tr>
        <tr>
          <td>m</td>
          <td>might</td>
          <td>m</td>
          <td>m</td>
          <td></td>
          <td>g</td>
          <td>gin</td>
          <td>dʒ</td>
          <td>j</td>
        </tr>
        <tr>
          <td>ng</td>
          <td>bring</td>
          <td>ŋ</td>
          <td>N</td>
          <td></td>
          <td>x</td>
          <td>mix</td>
          <td>ks</td>
          <td>ks</td>
        </tr>
        <tr>
          <td colspan="4" class="typeheader">Plosives</td>
          <td></td>
        </tr>
        <tr>
          <td>b</td>
          <td>bay</td>
          <td>b</td>
          <td>b</td>
          <td></td>
        </tr>
        <tr>
          <td>p</td>
          <td>pay</td>
          <td>p</td>
          <td>p</td>
        </tr>
        <tr>
          <td>d</td>
          <td>dye</td>
          <td>d</td>
          <td>d</td>
        </tr>
        <tr>
          <td>t</td>
          <td>tie</td>
          <td>t</td>
          <td>t</td>
        </tr>
        <tr>
          <td>g</td>
          <td>gut</td>
          <td>g</td>
          <td>g</td>
        </tr>
        <tr>
          <td>c</td>
          <td>cut</td>
          <td>k</td>
          <td>k</td>
        </tr>
      </table>
      <hr>
      <div id="il-entry">
        <form id="ilform">
          <p><label for="il">Enter Intermediate Language word:</label></p>
          <p><input type="text" id="il" name="il"></p>
          <p><input type="submit" id="il-submit" value="Make Image!"></p>
        </form>
      </div><br>
      <div>
        <canvas id="outputCanvas" height="30">
        </canvas>
      </div>
      
      
      <script>
        function produceImage(il, outputCanvas) {
          const outputImage = new Image();
          xOffset = 0;
          
          for (let i = 0; i < il.length; i++) {
            const char = il[i]
            const uppercase = 'AEIOUQNTHJS'
            if (uppercase.includes(char)) {
              const doubled = char.toLowerCase() + char.toLowerCase()
              charImage = new Image();
              charImage.src = `${doubled}.png`
              charImage.addEventListener("load", (e) => {
                width = Math.floor(charImage.width / 16.67);
                outputCanvas.width = xOffset + width;
                outputCanvas.getContext("2d").drawImage(charImage, xOffset, 0, width, 30);
                console.log(`Canvas width is ${outputCanvas.width} and xOffset is ${xOffset} and width is ${width}`);
                xOffset += width;
              }
              continue;
            }
            const lowercase = 'aeiounmbpdtgkvfszhrlcj'
            if (lowercase.includes(char)) {
              charImage = new Image();
              charImage.src = `${char}.png`
              charImage.addEventListener("load", (e) => {
                width = Math.floor(charImage.width / 16.67);
                outputCanvas.width = xOffset + width;
                outputCanvas.getContext("2d").drawImage(charImage, xOffset, 0, width, 30);
                console.log(`Canvas width is ${outputCanvas.width} and xOffset is ${xOffset} and width is ${width}`);
                xOffset += width;
              }
              continue;
            }
            console.log(`Unexpected character ${char}`)
          }
        }
        
        function makeImage(event) {
           event.preventDefault();
           let il = document.getElementById('il').value
           let outputCanvas = document.getElementById('outputCanvas')
           produceImage(il, outputCanvas)
        }

        const ilform = document.getElementById('ilform');
        ilform.addEventListener('submit',makeImage);
      </script>
    </body>
</html>
